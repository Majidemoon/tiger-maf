from tigerMaf import app, BOT_USERNAME
from tigerMaf.decorators import signin_required, check_user, check_block
from telethon import events
from tigerMaf.filters import step, is_private
from tigerMaf.sql_helpers import get_invite_count


@app.on(events.NewMessage(incoming=True, pattern=r"โููฺฉ ุฏุนูุชโ|/link", func=lambda e : step(e, "home") and is_private(e)))
@check_user
@signin_required
@check_block
async def invite_friends(event : events.NewMessage.Event):

    user_id = event.sender_id

    all_invites = get_invite_count(user_id)
    registered_invites = get_invite_count(user_id, registerd=True)

    invite_caption = f"""๐ฑุฑุจุงุช TIGER๐ฑ

ูุง ฺฉ ุฑุจุงุช ูุฎุตูุต ูุงูุง ูพูุฑ ูุง ุฏููุงุช ู ูุงูุง ุทุฑุงุญ ฺฉุฑุฏู

ูุงุจูุช ูุง ุฑุจุงุช๐

โญ๏ธูพุงู ุฎุตูุต: ุชุง ุญุงูุง ุดุฏู ุจุฎูุงุฏ ุจู ฺฉุณ ฺฉู ูุจูุง ุชู ุจุงุฒ ุฏุฏุฏ ูพุงู ุจุฏุฏ ูู ุขุฏ ุชูฺฏุฑุงูุด ุฑู ูุฏุงุดุชู ุจุงุดุฏุ ุงุฒ ุทุฑู ุงู ุฑุจุงุช ูุชููุฏ ุจูุด ูพุงู ุงุฑุณุงู ฺฉูุฏ

โญ๏ธูพุงู ูุงุดูุงุณ: ูุชููุฏ ูพุงู ูุงุดูุงุณ ุจู ูพูุฑ ูุง ูุงูุง ุงุฑุณุงู ฺฉูุฏ ุงุฑุณุงู ฺฉูุฏ๐ฝ

โญ๏ธูพุงู  ุจู ฺฉุงูุงู : ูพุงู ุดูุง ุจู ุตูุฑุช ุฎูุฏฺฉุงุฑ ููุฑุงู ุจุง ุงุณูุชูู ุฏุงุฎู ฺฉุงูุงู ูุฑุณุชุงุฏู ูุดู ู ุจูู ูุงูุง ูพูุฑ ูุง ูุชููู ูพุงู ุดูุง ุฑู ุจุจูู

โญ๏ธุฌุงุฒู ุฑูุฒุงูู:ูุฑ ุฑูุฒ ูุชููุฏ ฺฉ ุจุงุฑ ุดุงูุณุชูู ุฑู ุฏุฑ ุชุงุณุ ุจูููฺฏุ ุจุณฺฉุชุจุงูุ ููุชุจุงู ู ุฏุงุฑุช ุงูุชุญุงู ฺฉูุฏ ู ุฏุฑ ุตูุฑุช ุจุฑูุฏู ุดุฏู ุณฺฉู ูุงูุง ุฌุงุฒู ูฺฏุฑุฏ

โญ๏ธุฏูุฆู : ูุชููุฏ ุฏุฑ ุจุงุฒ ูุง ุชุงุณ ู ุจุณฺฉุชุจุงู, ุฏุงุฑุช ุดุฑุทโุจูุฏ ฺฉูุฏ

ุฏุฑ ุถูู ุจุง ุฏุนูุช ฺฉุฑุฏู ุฏูุณุชุงุชูู ูุชููุฏ ุณฺฉู ุฏุฑุงูุช ฺฉูุฏ

ุขุฏ ุฑุจุงุช ุชุงฺฏุฑ๐
https://t.me/{BOT_USERNAME}?start={user_id}

๐ฅโค๏ธโ๐ฅ
๐ฅโค๏ธโ๐ฅ๐ฅโค๏ธโ๐ฅ
๐ฅโค๏ธโ๐ฅ๐ฅโค๏ธโ๐ฅ๐ฅโค๏ธโ๐ฅ
๐ฅโค๏ธโ๐ฅ๐ฅโค๏ธโ๐ฅ๐ฅโค๏ธโ๐ฅ๐ฅโค๏ธโ๐ฅ"""
    
    invite_text = """ุงู ุจูุฑ ุงุฎุชุตุงุต ุดูุงุณุช๐

ูุฑ ฺฉุณ ฺฉู ุจุง ููฺฉ ุงุฎุชุตุงุต ุดูุง ูุงุฑุฏ ุฑุจุงุช ุจุดู ุจุฑุง ุดูุง ฺฉ ุฑูุฑุงู ุงุถุงูู ูุดู ู ูุฑ ุฑูุฑุงู ุจุฑุงุจุฑ ุงุณุช ุจุง 2 ุณฺฉู

โญ๏ธูฺฉุชู: ููุช ฺฉุงุฑุจุฑ ุจุง ููฺฉ ุฏุนูุช ุดูุง ูุงุฑุฏ ุฑุจุงุช ูุดู ุจุฑุง ุดูุง ูพุงู ุงุฑุณุงู ูุดูุ ู ุฒูุงู ฺฉู ุงูู ฺฉุงุฑุจุฑ ุซุจุช ูุงู ฺฉูู ุจุฑุง ุดูุง ฺฉููพู ุณฺฉู ุงุฑุณุงู ูุดู

โญ๏ธูฺฉุชู: ฺฉุณุง ฺฉู ุฏุนูุช ูฺฉูุฏ ุจุงุฏ ุญุฏุงูู 1000 ุงูุชุงุฒ ุฏุงุดุชู ุจุงุดูุฏ ุนู ุญุฏุงูู ุงู ูฺฏ๐ซ

๐ช๐
๐ช๐๐ช๐
๐ช๐๐ช๐๐ช๐
๐ช๐๐ช๐๐ช๐๐ช๐"""

    invite_text2 = f"""๐คุชุนุฏุงุฏ ุงูุฑุงุฏ ฺฉู ุชุง ุงูุงู ุจุง ููฺฉ ุดูุง ูุงุฑุฏ ุฑุจุงุช ุดุฏู:
{all_invites} ููุฑ

๐คุชุนุฏุงุฏ ุงูุฑุงุฏ ฺฉู ุชุง ุงูุงู ุจุง ููฺฉ ุดูุง ูุงุฑุฏ ุฑุจุงุช ุดุฏู ู ุซุจุช ูุงู ฺฉุฑุฏูุฏ:
{registered_invites} ููุฑ"""
    
    await app.send_file(user_id, "tigerMaf/files/invite/invite.jpg", caption=invite_caption)
    await event.respond(invite_text)
    await event.respond(invite_text2)
    return
